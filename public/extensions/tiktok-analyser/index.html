<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TikTok Analyser Pro - Download</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #0f0f23 0%, #1a1a3e 100%);
      color: #fff;
      min-height: 100vh;
      padding: 40px 20px;
    }
    
    .container {
      max-width: 800px;
      margin: 0 auto;
    }
    
    .header {
      text-align: center;
      margin-bottom: 40px;
    }
    
    .logo {
      font-size: 64px;
      margin-bottom: 16px;
    }
    
    h1 {
      font-size: 32px;
      margin-bottom: 8px;
      background: linear-gradient(135deg, #25f4ee 0%, #fe2c55 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .subtitle {
      color: rgba(255,255,255,0.6);
      font-size: 16px;
    }
    
    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 16px;
      margin-bottom: 40px;
    }
    
    .feature {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 12px;
      padding: 20px;
    }
    
    .feature-icon {
      font-size: 28px;
      margin-bottom: 8px;
    }
    
    .feature-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 4px;
    }
    
    .feature-desc {
      font-size: 12px;
      color: rgba(255,255,255,0.5);
    }
    
    .download-section {
      background: linear-gradient(135deg, rgba(37, 244, 238, 0.1) 0%, rgba(254, 44, 85, 0.1) 100%);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 16px;
      padding: 32px;
      text-align: center;
      margin-bottom: 40px;
    }
    
    .download-btn {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 16px 32px;
      background: linear-gradient(135deg, #fe2c55 0%, #ff6b6b 100%);
      border: none;
      border-radius: 12px;
      color: #fff;
      font-size: 18px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      margin-bottom: 16px;
    }
    
    .download-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 30px rgba(254, 44, 85, 0.4);
    }
    
    .download-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    
    .status {
      font-size: 14px;
      color: rgba(255,255,255,0.6);
      min-height: 20px;
    }
    
    .status.error {
      color: #f87171;
    }
    
    .status.success {
      color: #4ade80;
    }
    
    .instructions {
      background: rgba(255,255,255,0.03);
      border-radius: 12px;
      padding: 24px;
    }
    
    .instructions h2 {
      font-size: 18px;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .steps {
      list-style: none;
    }
    
    .step {
      display: flex;
      gap: 12px;
      margin-bottom: 16px;
      padding-bottom: 16px;
      border-bottom: 1px solid rgba(255,255,255,0.05);
    }
    
    .step:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }
    
    .step-num {
      width: 28px;
      height: 28px;
      background: linear-gradient(135deg, #25f4ee 0%, #fe2c55 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 14px;
      flex-shrink: 0;
    }
    
    .step-content h3 {
      font-size: 14px;
      margin-bottom: 4px;
    }
    
    .step-content p {
      font-size: 13px;
      color: rgba(255,255,255,0.6);
    }
    
    .step-content code {
      background: rgba(0,0,0,0.3);
      padding: 2px 8px;
      border-radius: 4px;
      font-family: monospace;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="logo">üìä</div>
      <h1>TikTok Analyser Pro</h1>
      <p class="subtitle">Extens√£o Chrome para an√°lise avan√ßada de perfis TikTok</p>
    </div>
    
    <div class="features">
      <div class="feature">
        <div class="feature-icon">üîç</div>
        <div class="feature-title">Filtros na P√°gina</div>
        <div class="feature-desc">Filtre e reordene os v√≠deos diretamente na tela do TikTok</div>
      </div>
      <div class="feature">
        <div class="feature-icon">üìä</div>
        <div class="feature-title">Ordena√ß√£o</div>
        <div class="feature-desc">Ordene por Views, Likes, Coment√°rios ou Data</div>
      </div>
      <div class="feature">
        <div class="feature-icon">üì•</div>
        <div class="feature-title">Download ZIP</div>
        <div class="feature-desc">Baixe m√∫ltiplos v√≠deos em um √∫nico arquivo ZIP</div>
      </div>
      <div class="feature">
        <div class="feature-icon">üìã</div>
        <div class="feature-title">Export CSV</div>
        <div class="feature-desc">Exporte links de download em CSV para uso externo</div>
      </div>
      <div class="feature">
        <div class="feature-icon">üîÑ</div>
        <div class="feature-title">Carregar Todos</div>
        <div class="feature-desc">Carrega automaticamente todos os v√≠deos do perfil</div>
      </div>
      <div class="feature">
        <div class="feature-icon">‚òëÔ∏è</div>
        <div class="feature-title">Sele√ß√£o</div>
        <div class="feature-desc">Selecione v√≠deos clicando diretamente neles</div>
      </div>
    </div>
    
    <div class="download-section">
      <button class="download-btn" id="download-btn" onclick="downloadExtension()">
        üì¶ Baixar Extens√£o (ZIP)
      </button>
      <div class="status" id="status"></div>
    </div>
    
    <div class="instructions">
      <h2>üìñ Como Instalar</h2>
      <ol class="steps">
        <li class="step">
          <div class="step-num">1</div>
          <div class="step-content">
            <h3>Baixe a extens√£o</h3>
            <p>Clique no bot√£o acima para baixar o arquivo ZIP</p>
          </div>
        </li>
        <li class="step">
          <div class="step-num">2</div>
          <div class="step-content">
            <h3>Extraia o ZIP</h3>
            <p>Descompacte o arquivo em uma pasta do seu computador</p>
          </div>
        </li>
        <li class="step">
          <div class="step-num">3</div>
          <div class="step-content">
            <h3>Abra as Extens√µes do Chrome</h3>
            <p>Acesse <code>chrome://extensions</code> no navegador</p>
          </div>
        </li>
        <li class="step">
          <div class="step-num">4</div>
          <div class="step-content">
            <h3>Ative o Modo Desenvolvedor</h3>
            <p>No canto superior direito, ative "Modo do desenvolvedor"</p>
          </div>
        </li>
        <li class="step">
          <div class="step-num">5</div>
          <div class="step-content">
            <h3>Carregue a extens√£o</h3>
            <p>Clique em "Carregar sem compacta√ß√£o" e selecione a pasta extra√≠da</p>
          </div>
        </li>
        <li class="step">
          <div class="step-num">6</div>
          <div class="step-content">
            <h3>Use no TikTok</h3>
            <p>Acesse um perfil TikTok e clique no bot√£o üìä que aparece no canto</p>
          </div>
        </li>
      </ol>
    </div>
  </div>
  
  <script src="vendor/jszip.min.js"></script>
  <script>
    const EXTENSION_FILES = [
      'manifest.json',
      'popup.html',
      'popup.js',
      'content.js',
      'content-styles.css',
      'background.js',
      'dashboard.html',
      'dashboard.js',
      'dashboard.css',
      'icons/icon16.png',
      'icons/icon48.png',
      'icons/icon128.png'
    ];
    
    function setStatus(text, type = '') {
      const el = document.getElementById('status');
      el.textContent = text;
      el.className = 'status ' + type;
    }
    
    async function downloadExtension() {
      const btn = document.getElementById('download-btn');
      btn.disabled = true;
      setStatus('Gerando extens√£o...');
      
      try {
        const zip = new JSZip();
        const basePath = window.location.pathname.replace('index.html', '').replace(/\/$/, '');
        
        let loadedCount = 0;
        let errors = [];
        
        for (const file of EXTENSION_FILES) {
          try {
            const url = `${basePath}/${file}`;
            const response = await fetch(url, { cache: 'no-store' });
            
            if (!response.ok) {
              console.warn(`File not found: ${file}`);
              errors.push(file);
              continue;
            }
            
            const content = await response.blob();
            
            if (content.size === 0) {
              console.warn(`Empty file: ${file}`);
              errors.push(file);
              continue;
            }
            
            zip.file(file, content);
            loadedCount++;
            setStatus(`Carregando ${loadedCount}/${EXTENSION_FILES.length} arquivos...`);
            
          } catch (e) {
            console.error(`Error loading ${file}:`, e);
            errors.push(file);
          }
        }
        
        if (loadedCount < 5) {
          throw new Error(`Poucos arquivos carregados (${loadedCount}). Verifique sua conex√£o.`);
        }
        
        setStatus('Compactando...');
        
        const blob = await zip.generateAsync({ type: 'blob' });
        
        if (blob.size < 1000) {
          throw new Error('ZIP gerado est√° muito pequeno. Tente novamente.');
        }
        
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'tiktok-analyser-pro.zip';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        if (errors.length > 0) {
          setStatus(`‚úÖ Download iniciado! (${errors.length} arquivos n√£o encontrados)`, 'success');
        } else {
          setStatus('‚úÖ Download iniciado! Extraia e instale no Chrome.', 'success');
        }
        
      } catch (e) {
        console.error('Download error:', e);
        setStatus('‚ùå Erro: ' + e.message, 'error');
      } finally {
        btn.disabled = false;
      }
    }
  </script>
</body>
</html>
